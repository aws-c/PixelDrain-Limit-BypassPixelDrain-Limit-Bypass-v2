    const convertButton = document.getElementById('convertButton');
    const copyButton = document.getElementById('copyButton');
    const saveButton = document.getElementById('saveButton');
    const inputUrls = document.getElementById('inputUrls');
    const outputUrls = document.getElementById('outputUrls');
    const albumUrlInput = document.getElementById('albumUrl');
    const getFilesButton = document.getElementById('getFilesButton');
    const games4uorg = document.getElementById('games4uorg');
    const closeAdButton = document.getElementById('closeAdButton');
    function getCookie(name) {
        const value = `; ${document.cookie}`;
        const parts = value.split(`; ${name}=`);
        if (parts.length === 2) return parts.pop().split(';').shift();
        return null;
    }
    function setCookie(name, value, days) {
        const date = new Date();
        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
        const expires = `expires=${date.toUTCString()}`;
        document.cookie = `${name}=${value}; ${expires}; path=/`;
    }

    window.onload = function() {
        const popupShown = getCookie('popupShown');
        if (!popupShown) {
            games4uorg.style.display = 'flex';
        }
    };
    closeAdButton.addEventListener('click', function() {
        games4uorg.style.display = 'none';
        setCookie('popupShown', 'true', 7);
    });

    getFilesButton.addEventListener('click', function() {
        const albumUrl = albumUrlInput.value;
        const albumId = albumUrl.split('/').pop();

        fetch(`https://pixeldrain.com/api/list/${albumId}`)
            .then(response => response.json())
            .then(data => {
                let output = '';
                if (data.files) {
                    data.files.forEach(file => {
                        output += `https://pixeldrain.com/u/${file.id} ${file.name}\n`;
                    });
                    inputUrls.value = output;
                } else {
                    inputUrls.value = 'Error: Unable to retrieve album information.';
                }
            })
            .catch(error => {
                inputUrls.value = 'Error: ' + error;
            });
    });

    convertButton.addEventListener('click', function() {
        const urls = inputUrls.value.split('\n').map(url => url.trim()).filter(Boolean);
        const convertedUrls = urls.map(url => {
            let match = url.match(/^https?:\/\/(?:pixeldra\.in|pixeldrain\.com|pixeldrain\.net)\/(u|api\/file)\/([^?\s]+)/);
            if (match) {
                return `https://pd.cybar.xyz/${match[2]}`;
            } else {
                return ''; 
            }
        }).filter(Boolean);

        const outputText = convertedUrls.join('\n');
        outputUrls.value = outputText;

        if (outputText.trim() !== '') {
            saveButton.style.display = 'block';
            copyButton.style.display = 'block';
        } else {
            saveButton.style.display = 'none';
            copyButton.style.display = 'none';
        }
    });

    copyButton.addEventListener('click', function() {
        outputUrls.select();
        document.execCommand('copy');
        alert('URLs copied to clipboard!');
    });

    saveButton.addEventListener('click', function() {
        const outputText = outputUrls.value;
        const blob = new Blob([outputText], { type: 'text/plain' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        
        a.href = url;
        a.download = 'converted-urls.txt';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
    });
	
	window.onload = function() {
    const currentDomain = window.location.hostname;

    // Check if the domain is under *.cybar.xyz
    if (!currentDomain.endsWith('.cybar.xyz')) {
        // Redirect to bypass URL if the domain doesn't match
        window.location.href = 'https://pixeldrain-bypass.cybar.xyz';
    }
};
